<h2>Create Stock Form (Reactive Form Arrays)</h2>

<div class="form-group">
  <form [formGroup]="stockForm" (ngSubmit)="onSubmit()">
    <div class="stock-name">
      <label for="stockName">Stock Name</label>
      <input
        type="text"
        placeholder="Stock Name"
        name="stockName"
        formControlName="name"
        class="block w-full px-3 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500"
      />
      <div
        *ngIf="
          stockForm.get('name')?.invalid &&
          (stockForm.get('name')?.dirty || stockForm.get('name')?.touched)
        "
        class="text-red-600 text-sm"
      >
        Name is required
      </div>
    </div>
    <div class="stock-code">
      <label for="stockCode">Stock Code</label>
      <input
        type="text"
        placeholder="Stock Code"
        formControlName="code"
        class="block w-full px-3 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500"
      />
      <div
        *ngIf="
          stockForm.get('code')?.invalid &&
          (stockForm.get('code')?.dirty || stockForm.get('code')?.touched)
        "
        class="text-red-600 text-sm"
      >
        <div *ngIf="stockForm.get('code')?.errors?.['required']">
          Stock Code is required
        </div>
        <div *ngIf="stockForm.get('code')?.errors?.['minlength']">
          Stock Code must be atleast 2 characters
        </div>
      </div>
    </div>
    <div class="stock-price">
      <label for="stockPrice">Stock Price</label>
      <input
        type="number"
        placeholder="Stock Price"
        formControlName="price"
        class="block w-full px-3 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500"
      />
      <div
        *ngIf="
          stockForm.get('price')?.invalid &&
          (stockForm.get('price')?.dirty || stockForm.get('price')?.touched)
        "
        class="text-red-600 text-sm"
      >
        <div *ngIf="stockForm.get('price')?.errors?.['required']">
          Stock Price is required
        </div>
        <div *ngIf="stockForm.get('price')?.errors?.['min']">
          Stock price must be positive
        </div>
      </div>
    </div>
    <br />
    <div formArrayName="notablePeople">
      <div
        *ngFor="let person of notablePeople.controls; let i = index"
        [formGroupName]="i"
        class="notable-people"
      >
        <div>Person {{ i + 1 }}</div>
        <br />

        <label for="name">Person Name</label>
        <input
          type="text"
          placeholder="Person Name"
          formControlName="name"
          class="block w-full px-3 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500"
        />

        <br />

        <label for="title">Person Title</label>
        <input
          type="text"
          placeholder="Person Title"
          formControlName="title"
          class="block w-full px-3 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500"
        />

        <br />
        <button
          type="button"
          class="px-2 py-1 bg-sky-500 text-white rounded hover:bg-sky-600"
          (click)="removeNotablePerson(i)"
        >
          Remove Person
        </button>
      </div>
    </div>
    <br />
    <button
      type="button"
      class="px-2 py-1 bg-gray-500 text-white rounded hover:bg-gray-600 m-1"
      (click)="addNotablePerson()"
    >
      Add Notable Person
    </button>
    <button
      type="submit"
      class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 m-1"
    >
      Submit
    </button>
    <button
      type="button"
      (click)="resetForm()"
      class="px-2 py-1 bg-yellow-400 text-black rounded hover:bg-yellow-500 m-1"
    >
      Reset
    </button>
  </form>
</div>

<p>Form Control value: {{ stockForm.value | json }}</p>
<p>Form Control status: {{ stockForm.status | json }}</p>
<p>Stock Value: {{ stock | json }}</p>
