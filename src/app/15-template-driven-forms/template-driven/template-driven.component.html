<section class="layout-shell">
  <header class="layout-header">
    <p class="eyebrow">Template driven forms</p>
    <h2>Product form definition</h2>
    <p class="layout-subtext">
      Bind inputs with ngModel and validate using template driven rules.
    </p>
  </header>

  <form
    novalidate
    class="product-form"
    (ngSubmit)="onSubmit(productForm)"
    #productForm="ngForm"
  >
    <div class="form-grid">
      <section class="form-panel">
        <h3>Product details</h3>
        <div class="mb-3">
          <label for="name" class="form-label">Product Name</label>
          <input
            id="name"
            type="text"
            class="form-control"
            [class.is-invalid]="
              name.invalid &&
              (name.dirty || name.touched || productForm.submitted)
            "
            required
            minlength="5"
            name="name"
            [(ngModel)]="product.name"
            #name="ngModel"
            placeholder="Product Name"
          />
          @if (
            name.errors && (name.dirty || name.touched || productForm.submitted)
          ) {
            <div>
              @if (name.errors["required"]) {
                <div class="invalid-feedback d-block">name is required</div>
              }
              @if (name.errors["minlength"]) {
                <div class="invalid-feedback d-block">
                  Name length must be greater than 5 but actual length is
                  {{ name.errors["minlength"].actualLength }}
                </div>
              }
            </div>
          }
        </div>
        <div class="mb-3">
          <label for="category" class="form-label">Category</label>
          <select
            class="form-select"
            id="category"
            required
            [(ngModel)]="product.category"
            name="category"
          >
            @for (category of categories; track category) {
              <option [value]="category.id">
                {{ category.name }}
              </option>
            }
          </select>
        </div>
        <div class="mb-3">
          <label for="price" class="form-label">Price</label>
          <input
            id="price"
            type="text"
            class="form-control"
            name="price"
            [(ngModel)]="product.price"
          />
        </div>
        @if (
          productForm.dirty && productForm.invalid && productForm.submitted
        ) {
          <ul class="error-list">
            @for (error of getValidationMessages(name); track error) {
              <li>
                {{ error }}
              </li>
            }
          </ul>
        }
      </section>

      <aside class="form-aside">
        <h3>Live preview</h3>
        <div class="summary-row">
          <span>Name</span>
          <strong>{{ product.name || "Not set" }}</strong>
        </div>
        <div class="summary-row">
          <span>Category</span>
          <strong>{{ product.category || "Not set" }}</strong>
        </div>
        <div class="summary-row">
          <span>Price</span>
          <strong>{{ product.price || "0" }}</strong>
        </div>
        <div class="status-chip" [class.invalid]="productForm.invalid">
          {{ productForm.valid ? "Form ready" : "Form incomplete" }}
        </div>
      </aside>
    </div>

    <div class="form-actions">
      <button type="submit" class="btn btn-primary me-2">Submit</button>
      <button
        type="button"
        class="btn btn-outline-secondary me-2"
        (click)="reset(productForm)"
      >
        Reset
      </button>
      <button
        type="button"
        class="btn btn-secondary"
        (click)="preset(productForm)"
      >
        Default Values
      </button>
    </div>
  </form>
</section>
